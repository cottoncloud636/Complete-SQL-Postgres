-- correlated subquery in select 

/***************************************** Problem 1 **********************************************/
/*
Display the max amount spent for every customer of each their payment

Table -- payment, sample:

| payment_id | customer_id | staff_id | rental_id | amount | payment_date                       |
|------------|-------------|----------|-----------|--------|-------------------------------------|
| 16050      | 269         | 2        | 7         | 1.99   | 2020-01-24 22:40:19.996577+01       |
| 16051      | 269         | 1        | 98        | 0.99   | 2020-01-25 16:16:50.996577+01       |
| 16052      | 269         | 2        | 678       | 6.99   | 2020-01-28 22:44:14.996577+01       |
| 16053      | 269         | 2        | 703       | 0.99   | 2020-01-29 01:58:02.996577+01       |
| 16054      | 269         | 1        | 750       | 4.99   | 2020-01-29 09:10:06.996577+01       |
| 16055      | 269         | 2        | 1099      | 2.99   | 2020-01-31 13:23:14.996577+01       |

*/
select
	*,
	(select max(amount) from payment p2
	 where p1.customer_id = p2.customer_id
	)
from payment p1
order by customer_id

-- output report, sample:
  
| payment_id | customer_id | staff_id | rental_id | amount | payment_date                       | max   |
|------------|-------------|----------|-----------|--------|-------------------------------------|-------|
| 16677      | 1           | 1        | 76        | 2.99   | 2020-01-25 10:59:03.996577+01       | 9.99  |
| 16678      | 1           | 1        | 573       | 0.99   | 2020-01-28 10:03:49.996577+01       | 9.99  |
| 18495      | 1           | 1        | 1185      | 5.99   | 2020-02-15 00:22:38.996577+01       | 9.99  |
| 18496      | 1           | 2        | 1422      | 0.99   | 2020-02-15 17:31:19.996577+01       | 9.99  |
| 18497      | 1           | 2        | 1476      | 9.99   | 2020-02-15 20:37:12.996577+01       | 9.99  |
| 18498      | 1           | 1        | 1725      | 4.99   | 2020-02-16 14:47:23.996577+01       | 9.99  |
| 18499      | 1           | 1        | 2308      | 4.99   | 2020-02-18 08:10:14.996577+01       | 9.99  |


/***************************************** Problem 2 **********************************************/

